//- views/clientes/index.pug
extends ../layout/layout

block content
  .d-flex.justify-content-between.align-items-center.mb-4
    div
      h1 
        i.bi.bi-people-fill.me-2
        | Gestión de Clientes
      p.text-muted Administra tu cartera de clientes
    a.btn.btn-primary(href="/clientes/nuevo")
      i.bi.bi-plus-circle.me-2
      | Nuevo Cliente

  //- Filtros y búsqueda
  //- .card.mb-4
  //-   .card-body
  //-     .row
  //-       .col-md-8
  //-         .input-group
  //-           input.form-control(type="text", placeholder="Buscar cliente...", id="searchInput")
  //-           button.btn.btn-outline-primary(type="button", id="searchBtn")
  //-             i.bi.bi-search.me-2
  //-             | Buscar
  //-       .col-md-4
  //-         select.form-select#filterType
  //-           option(value="all") Todos los tipos
  //-           option(value="empresa") Empresas
  //-           option(value="individual") Individuales

  //- Tabla de clientes
  .card
    .card-body
      if clientes && clientes.length > 0
        .table-responsive
          table.table.table-hover
            thead.table-dark
              tr
                th ID
                th Nombre
                th Empresa
                th Contacto
                th Tipo
                th Acciones
            tbody
              each cliente in clientes
                tr
                  td= cliente.id
                  td= cliente.nombre
                  td= cliente.empresa || 'Sin empresa'
                  td
                    div= cliente.email
                    small.text-muted= cliente.telefono || 'Sin teléfono'
                  td
                    span.badge(class=cliente.tipo === 'empresa' ? 'bg-primary' : 'bg-success')= cliente.tipo
                  td
                    .btn-group
                      a.btn.btn-sm.btn-outline-primary(href=`/clientes/${cliente.id}`)
                        i.bi.bi-eye
                      a.btn.btn-sm.btn-outline-secondary(href=`/clientes/editar/${cliente.id}`)
                        i.bi.bi-pencil
                      //- button.btn.btn-sm.btn-outline-danger(type="button", onclick=`confirmDelete(${cliente.id})`)
                      //-   i.bi.bi-trash
                      form(action=`/clientes/${cliente.id}?_method=DELETE`, method="POST", style="display:inline")
                        button.btn.btn-sm.btn-outline-danger(type="submit" onclick="return confirm('¿Eliminar cliente?')")
                          i.bi.bi-trash
      else
        .text-center.py-5
          i.bi.bi-people.fs-1.text-muted
          p.mt-3 No hay clientes registrados
          a.btn.btn-primary(href="/clientes/nuevo") Agregar primer cliente

//- block scripts
//-   script.
//-     function confirmDelete(id) {
//-       if (confirm('¿Estás seguro de eliminar este cliente?')) {
//-         fetch(`/api/clientes/${id}`, { method: 'DELETE' })
//-           .then(response => response.json())
//-           .then(data => {
//-             if (data.mensaje) {
//-               alert(data.mensaje);
//-               location.reload();
//-             }
//-           })
//-           .catch(error => console.error('Error:', error));
//-       }
//-     }
    