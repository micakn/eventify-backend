//- views/layout/layout.pug
doctype html
html(lang="es")
  head
    meta(charset="UTF-8")
    meta(name="viewport", content="width=device-width, initial-scale=1.0")
    title= title || 'Eventify - Sistema de Gesti贸n'
    link(href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css", rel="stylesheet")
    link(rel="stylesheet", href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css")
    link(rel="stylesheet", href="/css/styles.css")
    block styles

  body
    //- HEADER con usuario / login
    header.bg-dark.text-white.mb-3
      .container-fluid.d-flex.justify-content-between.align-items-center.py-2
        //- Logo / marca
        a.d-flex.align-items-center.text-decoration-none.text-white(href="/")
          i.bi.bi-calendar-event.fs-4.me-2
          span.fs-5 Eventify

        //- Secci贸n de usuario (autenticado o no)
        if usuario
          .dropdown
            button.btn.btn-outline-light.dropdown-toggle(
              type='button'
              data-bs-toggle='dropdown'
              aria-expanded='false'
            )
              i.bi.bi-person-circle.me-1
              |  #{usuario.nombre}
            ul.dropdown-menu.dropdown-menu-end
              li
                .dropdown-item-text
                  small.text-muted= usuario.rol
              li
                hr.dropdown-divider
              li
                a.dropdown-item(href='/auth/perfil')
                  i.bi.bi-person.me-2
                  |  Mi Perfil
              li
                hr.dropdown-divider
              li
                a.dropdown-item.text-danger(
                  href='/auth/logout'
                  onclick='return confirm("驴Est谩s seguro que deseas cerrar sesi贸n?")'
                )
                  i.bi.bi-box-arrow-right.me-2
                  |  Cerrar Sesi贸n
        else
          .btn-group(role='group')
            a.btn.btn-outline-light.btn-sm(href='/auth/login')
              i.bi.bi-box-arrow-in-right.me-1
              | Iniciar Sesi贸n
            a.btn.btn-light.btn-sm(href='/auth/registro')
              i.bi.bi-person-plus.me-1
              | Registrarse

    //- Wrapper flex para sticky footer
    .main-wrapper.d-flex.flex-column.min-vh-100
      .container-fluid.flex-grow-1
        .row
          //- Sidebar
          .col-md-3.col-lg-2.sidebar.p-3
            .text-center.mb-4
              h4 
                i.bi.bi-calendar-event.text-primary.me-2
                | Eventify
              hr
            
            //-  Informaci贸n de Usuario en Sidebar
            if usuario
              .alert.alert-info.py-2.px-3.mb-3
                .d-flex.align-items-center
                  i.bi.bi-person-circle.fs-3.me-2
                  div
                    strong.d-block= usuario.nombre
                    small.text-muted= usuario.area
            else
              .alert.alert-warning.py-2.px-3.mb-3
                .text-center
                  i.bi.bi-exclamation-triangle.me-1
                  small Sin sesi贸n iniciada
            
            ul.nav.flex-column
              li.nav-item
                a.nav-link(class=(currentPath === '/' ? 'active' : ''), href="/")
                  i.bi.bi-house.me-2
                  | Inicio
                  if !usuario
                    |  
                    i.bi.bi-lock-fill.text-warning.small
              
              li.nav-item
                a.nav-link(class=(currentPath.startsWith('/clientes') ? 'active' : ''), href="/clientes")
                  i.bi.bi-people-fill.me-2
                  | Clientes
                  if !usuario
                    |  
                    i.bi.bi-lock-fill.text-warning.small
              
              li.nav-item
                a.nav-link(class=(currentPath.startsWith('/eventos') ? 'active' : ''), href="/eventos")
                  i.bi.bi-calendar-event.me-2
                  | Eventos
                  if !usuario
                    |  
                    i.bi.bi-lock-fill.text-warning.small
              
              li.nav-item
                a.nav-link(class=(currentPath.startsWith('/empleados') ? 'active' : ''), href="/empleados")
                  i.bi.bi-person-badge.me-2
                  | Empleados
                  if !usuario
                    |  
                    i.bi.bi-lock-fill.text-warning.small
              
              li.nav-item
                a.nav-link(class=(currentPath.startsWith('/tareas') ? 'active' : ''), href="/tareas")
                  i.bi.bi-list-task.me-2
                  | Tareas
                  if !usuario
                    |  
                    i.bi.bi-lock-fill.text-warning.small
            
            //-  Botones de Autenticaci贸n en Sidebar
            hr.my-3
            if usuario
              .d-grid
                a.btn.btn-outline-danger.btn-sm(
                  href='/auth/logout'
                  onclick='return confirm("驴Cerrar sesi贸n?")'
                )
                  i.bi.bi-box-arrow-right.me-1
                  | Cerrar Sesi贸n
            else
              .d-grid.gap-2
                a.btn.btn-primary.btn-sm(href='/auth/login')
                  i.bi.bi-box-arrow-in-right.me-1
                  | Iniciar Sesi贸n
                a.btn.btn-outline-primary.btn-sm(href='/auth/registro')
                  i.bi.bi-person-plus.me-1
                  | Registrarse

          //- Main Content
          .col-md-9.col-lg-10.main-content.p-4
            block content

      //- Footer pegado abajo
      footer.bg-dark.text-white.py-3.mt-auto
        .container
          .row
            .col-md-6
              p.mb-0 漏 2025 Eventify - Sistema de Gesti贸n de Eventos
            .col-md-6.text-md-end
              small Versi贸n 1.0.0

    script(src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js")
    script(src="/js/filtros.js")
    block scripts